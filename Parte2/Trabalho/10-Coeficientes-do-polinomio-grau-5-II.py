import numpy as np
# import scipy as sp

def best_poly (x, y, k):
    n = len(x)
    if n <= k:
        raise ValueError('O número de pontos deve ser maior que k (o grau do polinônmio)')

    somas = {}
    somas[0] = n
    for n in range(1, 2*k + 1):
        somas[n] = sum(xi ** n for xi in x)
    A = []
    B = []
    for i in range (k + 1):
        row = []
        for j in range(k + 1):
            row.append(somas[i + j])
        A.append(row)
        if i == 0:
            B.append(sum(y))
        else:
            B.append(sum(xi ** i * yi for xi, yi in zip(x,y)))
    return np.linalg.solve(A, B)

x = [-4.1681, -4.1147, -4.0112, -3.9217, -3.8749, -3.7211, -3.6527, -3.5621, -3.498, -3.4234, -3.308, -3.2469, -3.1581, -3.0605, -2.9294, -2.858, -2.762, -2.6977, -2.574, -2.5551, -2.4589, -2.3627, -2.2679, -2.1666, -2.0929, -2.0263, -1.92, -1.8479, -1.7521, -1.6109, -1.5534, -1.4951, -1.3377, -1.2511, -1.1783, -1.0861, -0.976, -0.9156, -0.8023, -0.776, -0.6221, -0.5818, -0.5117, -0.3837, -0.3234, -0.2426, -0.111, -0.0742, 0.0019, 0.0965, 0.2147, 0.3293, 0.42, 0.4723, 0.6162, 0.6255, 0.7089, 0.8782, 0.9521, 1.0048, 1.071, 1.2053, 1.2946, 1.3733, 1.4597, 1.5261, 1.6353, 1.7288, 1.8473, 1.9311, 1.9777, 2.1122, 2.1625, 2.301, 2.3495, 2.4476, 2.4931, 2.5792, 2.7177, 2.8115, 2.9072, 2.9348, 3.0126, 3.1289, 3.2649, 3.3249, 3.4417, 3.5039, 3.6043, 3.7012, 3.7547, 3.8107, 3.9721, 4.0268, 4.158, 4.2262]
y = [3.2727, 4.1601, 4.8073, 5.6056, 5.5252, 5.4261, 5.1793, 7.1674, 7.5348, 7.3959, 7.9229, 7.1726, 7.3929, 7.4446, 7.5605, 7.3451, 6.7689, 7.1865, 6.3532, 7.0956, 7.5569, 5.7653, 5.4811, 5.8599, 5.1706, 4.5549, 4.9055, 4.8553, 4.3168, 4.128, 4.0919, 4.3824, 3.9419, 4.0558, 3.8823, 4.0374, 3.9012, 4.0402, 3.9484, 3.9015, 5.3177, 4.3397, 4.5268, 6.0606, 4.3991, 3.9545, 5.0457, 4.8459, 4.9064, 4.4909, 5.0753, 5.459, 5.7925, 5.7971, 6.0301, 6.0455, 4.3812, 5.7608, 5.8101, 6.067, 4.2694, 6.1317, 6.1419, 6.1053, 5.7631, 6.0051, 5.6236, 5.0206, 5.4585, 5.0878, 4.5983, 5.1846, 4.5448, 4.3322, 4.1571, 3.773, 3.6199, 3.3192, 3.2381, 2.8922, 2.8323, 0.7174, 4.1731, 2.3506, 1.5862, 2.3506, 2.598, 2.6025, 1.9958, 2.8622, 3.3808, 3.3772, 4.7139, 5.3241, 6.4713, 7.7709]

a0, a1, a2, a3, a4, a5 = best_poly(x, y, 5)

print(f'{a0 = } , {a1 = }, {a2 = }, {a3 = }, {a4 =}, {a5 =}')
