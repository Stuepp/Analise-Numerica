import numpy as np
# import scipy as sp

def best_poly (x, y, k):
    n = len(x)
    if n <= k:
        raise ValueError('O número de pontos deve ser maior que k (o grau do polinônmio)')

    somas = {}
    somas[0] = n
    for n in range(1, 2*k + 1):
        somas[n] = sum(xi ** n for xi in x)
    A = []
    B = []
    for i in range (k + 1):
        row = []
        for j in range(k + 1):
            row.append(somas[i + j])
        A.append(row)
        if i == 0:
            B.append(sum(y))
        else:
            B.append(sum(xi ** i * yi for xi, yi in zip(x,y)))
    return np.linalg.solve(A, B)

x = [-4.4475, -4.3317, -4.2376, -4.1809, -4.0221, -3.9927, -3.8536, -3.7698, -3.6772, -3.5386, -3.4343, -3.3879, -3.3214, -3.1688, -3.0787, -3.0183, -2.8721, -2.7971, -2.7511, -2.6531, -2.5271, -2.403, -2.2877, -2.1978, -2.154, -2.06, -1.9415, -1.8312, -1.7705, -1.6016, -1.5269, -1.4434, -1.3531, -1.298, -1.134, -1.0347, -0.9507, -0.9001, -0.7743, -0.6814, -0.5842, -0.4932, -0.3929, -0.2873, -0.2176, -0.1023, 0.0327, 0.0838, 0.1674, 0.296, 0.353, 0.4737, 0.5466, 0.6916, 0.79, 0.8922, 0.9719, 1.0865, 1.1691, 1.2535, 1.3764, 1.4407, 1.5336, 1.7016, 1.7665, 1.849, 1.9628, 2.0733, 2.1473, 2.2157, 2.3185, 2.4083, 2.5346, 2.5914, 2.6757, 2.8342, 2.9239, 3.0326, 3.1117, 3.2276, 3.2754, 3.4194, 3.4887, 3.5517, 3.6882, 3.8112, 3.8982, 3.9629, 4.0406, 4.1779, 4.275, 4.3783, 4.4584, 4.5516, 4.6422, 4.7161, 4.8562, 4.9151]
y = [2.125, 3.3128, 3.8346, 3.9639, 5.5183, 5.009, 5.4842, 5.8789, 7.0718, 6.7825, 6.5205, 6.7042, 7.071, 6.9654, 6.9352, 7.3254, 8.8495, 6.9243, 7.0728, 7.2791, 6.4133, 6.9009, 6.8386, 6.7783, 6.7961, 6.4542, 6.2364, 6.2503, 5.9299, 4.9655, 5.7499, 6.5222, 5.1884, 5.5038, 5.0293, 5.7797, 5.0489, 4.2007, 3.7625, 4.149, 4.6211, 4.3101, 4.3409, 4.1418, 4.2554, 4.3408, 5.6816, 3.1712, 3.8117, 2.381, 4.4686, 3.8286, 4.3569, 4.7057, 4.9038, 4.8848, 5.0793, 4.3974, 5.1999, 5.3986, 5.6226, 5.5571, 5.9647, 6.2877, 6.4864, 6.5678, 6.8697, 7.038, 7.0792, 7.1837, 7.3152, 7.3257, 8.0327, 8.266, 8.1241, 8.4164, 8.8356, 8.7214, 6.9479, 8.9082, 9.03, 9.3201, 7.5171, 9.4655, 9.2151, 10.1121, 9.4039, 9.2724, 8.9941, 8.5927, 8.2778, 8.0719, 7.7126, 8.0674, 7.2155, 6.5654, 7.7825, 5.7561]

a0, a1, a2, a3, a4 = best_poly(x, y, 4)

print(f'{a0 = } , {a1 = }, {a2 = }, {a3 = }, {a4 =}')
