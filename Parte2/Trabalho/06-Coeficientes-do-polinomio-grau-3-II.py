import numpy as np
# import scipy as sp

def best_poly (x, y, k):
    n = len(x)
    if n <= k:
        raise ValueError('O número de pontos deve ser maior que k (o grau do polinônmio)')

    somas = {}
    somas[0] = n
    for n in range(1, 2*k + 1):
        somas[n] = sum(xi ** n for xi in x)
    A = []
    B = []
    for i in range (k + 1):
        row = []
        for j in range(k + 1):
            row.append(somas[i + j])
        A.append(row)
        if i == 0:
            B.append(sum(y))
        else:
            B.append(sum(xi ** i * yi for xi, yi in zip(x,y)))
    return np.linalg.solve(A, B)

x = [-4.9279, -4.7408, -4.6832, -4.5048, -4.3502, -4.2577, -4.1611, -3.9468, -3.8884, -3.7195, -3.6527, -3.5034, -3.2811, -3.1387, -3.0067, -2.9802, -2.7551, -2.6821, -2.5117, -2.4005, -2.2352, -2.1145, -1.949, -1.7945, -1.6586, -1.6402, -1.384, -1.2583, -1.2027, -1.0311, -0.8502, -0.7353, -0.645, -0.5319, -0.3598, -0.3028, -0.0643, -0.0359, 0.2291, 0.2529, 0.4815, 0.5084, 0.6385, 0.8096, 0.9226, 1.071, 1.2897, 1.3495, 1.4911, 1.6641, 1.7824, 1.8484, 2.0209, 2.1415, 2.3368, 2.3876, 2.5953, 2.69, 2.8167, 3.0048, 3.0598, 3.2071, 3.4402, 3.515, 3.6539, 3.7236, 3.8897, 4.0942, 4.1725, 4.3489, 4.5202, 4.5606, 4.7768, 4.845, 4.9438, 5.0711, 5.2982, 5.3995, 5.5469, 5.6216, 5.7681, 5.8737]
y = [1.7473, 2.4783, 3.2537, 2.8365, 3.1057, 3.4277, 3.6265, 3.885, 3.8374, 4.2792, 4.2378, 4.452, 5.2122, 4.9535, 4.7754, 4.9977, 5.7498, 5.3748, 5.1013, 5.1439, 5.4643, 5.299, 5.3453, 5.2069, 5.4244, 5.2297, 5.0647, 4.8982, 4.9848, 5.0681, 5.0913, 4.7468, 4.7447, 4.9168, 4.8398, 5.4647, 4.5738, 4.6283, 4.5728, 4.5016, 3.9865, 3.2719, 4.1156, 4.4834, 3.6279, 4.0202, 2.9762, 4.2713, 3.8279, 4.4835, 3.7449, 3.606, 3.6899, 3.8376, 4.4538, 3.694, 3.8893, 4.1108, 4.035, 4.4033, 4.1784, 2.6851, 4.5569, 4.4118, 4.3774, 4.7245, 5.742, 5.3195, 5.561, 5.543, 6.0088, 5.9861, 6.5118, 6.6754, 7.1451, 7.7347, 8.8773, 7.4605, 9.0839, 9.4467, 9.6925, 11.2332]

a0, a1, a2, a3 = best_poly(x, y, 3)

print(f'{a0 = } , {a1 = }, {a2 = }, {a3 = }')
