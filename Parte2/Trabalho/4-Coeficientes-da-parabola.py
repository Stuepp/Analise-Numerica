import numpy as np
# import scipy as sp

def best_poly (x, y, k):
    n = len(x)
    if n <= k:
        raise ValueError('O número de pontos deve ser maior que k (o grau do polinônmio)')

    somas = {}
    somas[0] = n
    for n in range(1, 2*k + 1):
        somas[n] = sum(xi ** n for xi in x)
    A = []
    B = []
    for i in range (k + 1):
        row = []
        for j in range(k + 1):
            row.append(somas[i + j])
        A.append(row)
        if i == 0:
            B.append(sum(y))
        else:
            B.append(sum(xi ** i * yi for xi, yi in zip(x,y)))
    return np.linalg.solve(A, B)

x = [0.0796, 0.2175, 0.2845, 0.3824, 0.5007, 0.5972, 0.808, 0.8248, 1.0242, 1.1499, 1.2734, 1.3415, 1.4817, 1.5613, 1.6508, 1.8042, 1.8798, 2.0092, 2.1829, 2.2888, 2.3693, 2.4804, 2.6536, 2.7555, 2.8493, 2.9664, 3.0726, 3.2337, 3.369, 3.4024, 3.5227, 3.6688, 3.7249, 3.8696, 4.0235, 4.1078, 4.1993, 4.3701, 4.47, 4.631, 4.671, 4.7719, 4.9426, 5.1046, 5.1804, 5.305, 5.4432, 5.5245, 5.6312, 5.7144, 5.8394, 6.0101, 6.138, 6.1782, 6.2951, 6.4927, 6.517, 6.7233, 6.8093, 6.9596, 7.0605, 7.1979, 7.2946, 7.4041, 7.5341, 7.5826, 7.726, 7.8882, 7.9807, 8.0289, 8.2179, 8.3118, 8.4435, 8.5144, 8.711, 8.7429, 8.9444, 9.0304, 9.1425, 9.207, 9.3165, 9.4406, 9.5389, 9.676, 9.7685, 9.901]
y = [4.9849, 5.27, 5.5498, 4.9909, 4.6973, 4.978, 4.8098, 4.7879, 4.2772, 4.2883, 4.4327, 3.9419, 2.8355, 4.287, 3.9548, 3.6426, 3.9867, 3.6945, 3.4462, 3.8566, 2.9544, 2.7582, 4.4377, 5.1363, 4.1162, 3.2604, 3.722, 3.4719, 2.702, 3.3188, 4.9894, 3.1443, 3.0557, 2.8995, 2.8159, 3.2647, 3.5165, 2.8592, 2.9979, 2.6352, 2.904, 3.2076, 2.7791, 2.8244, 2.8162, 3.8847, 2.8957, 3.0683, 3.0574, 2.3123, 4.0944, 3.1589, 3.3585, 1.7728, 3.9095, 2.2293, 3.5497, 3.2969, 3.1673, 3.339, 3.4107, 3.5975, 3.5228, 3.4763, 3.295, 3.0173, 4.0564, 3.6423, 3.8516, 4.5734, 4.5123, 4.4917, 4.173, 6.102, 4.3502, 4.8951, 4.9673, 4.9333, 4.6599, 4.9992, 5.0966, 4.9587, 5.4286, 5.1995, 5.7049, 5.6655]
a0, a1, a2 = best_poly(x, y, 2)

print(f'{a0 = } , {a1 = }, {a2 = }')
